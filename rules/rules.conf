# miniIDS Rules Configuration
# Format: alert <proto> <src_ip> <src_port> -> <dst_ip> <dst_port> (content|flags:"pattern"; msg:"description";)

# miniIDS/IPS Rules Configuration
# Actions: alert (detect only), drop (block silently), reject (block + send RST/ICMP)
# Format: <action> <proto> <src_ip> <src_port> -> <dst_ip> <dst_port> (<type>:"<pattern>"; msg:"<description>";)

# HTTP Content-based detection rules (alert only)
alert tcp any any -> any 80 (content:"GET"; msg:"HTTP GET Request";)
alert tcp any any -> any 8080 (content:"GET"; msg:"HTTP Request on port 8080";)
alert tcp any any -> any 8888 (content:"GET"; msg:"HTTP Request on port 8888";)

# Directory traversal - DROP in IPS mode
drop tcp any any -> any 80 (content:"../"; msg:"Directory Traversal Attempt - BLOCKED";)
drop tcp any any -> any 8080 (content:"../"; msg:"Directory Traversal on 8080 - BLOCKED";)

# Sensitive file access - REJECT in IPS mode
reject tcp any any -> any 80 (content:"/etc/passwd"; msg:"Sensitive File Access - REJECTED";)
reject tcp any any -> any 8080 (content:"/etc/shadow"; msg:"Shadow File Access - REJECTED";)

# Malicious content detection - DROP
drop tcp any any -> any 9002 (content:"malware"; msg:"Malware Signature - DROPPED";)
drop tcp any any -> any 9003 (content:"attack"; msg:"Attack Pattern - DROPPED";)

# TCP flag-based detection rules (alert only)
alert tcp any any -> any 22 (flags:"SYN"; msg:"SSH Port Scan Detected";)
alert tcp any any -> any 80 (flags:"SYN"; msg:"HTTP Port Scan Detected";)
alert tcp any any -> any 443 (flags:"FIN"; msg:"FIN Scan on HTTPS";)
alert tcp any any -> any 8080 (flags:"PSH"; msg:"TCP PUSH on 8080";)

# Port scan detection - REJECT aggressive scans
reject tcp any any -> any 22 (flags:"FIN"; msg:"FIN Scan on SSH - REJECTED";)
reject tcp any any -> any 23 (flags:"SYN"; msg:"Telnet Scan - REJECTED";)