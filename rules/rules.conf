# miniIDS Rules Configuration
# Format: alert <proto> <src_ip> <src_port> -> <dst_ip> <dst_port> (content|flags:"pattern"; msg:"description";)

# HTTP Content-based detection rules
alert tcp any any -> any 80 (content:"GET"; msg:"HTTP GET Request";)
alert tcp any any -> any 8080 (content:"GET"; msg:"HTTP Request on port 8080";)
alert tcp any any -> any 8888 (content:"GET"; msg:"HTTP Request on port 8888";)
alert tcp any any -> any 9000 (content:"../"; msg:"Directory Traversal Attempt";)
alert tcp any any -> any 9001 (content:"/etc/passwd"; msg:"Sensitive File Access Attempt";)

# Malicious content detection (on various common ports)
alert tcp any any -> any 9002 (content:"malware"; msg:"Malware Signature Detected";)
alert tcp any any -> any 9003 (content:"attack"; msg:"Attack Pattern Detected";)

# TCP flag-based detection rules  
alert tcp any any -> any 22 (flags:"SYN"; msg:"SSH Port Scan Detected";)
alert tcp any any -> any 80 (flags:"SYN"; msg:"HTTP Port Scan Detected";)
alert tcp any any -> any 443 (flags:"FIN"; msg:"FIN Scan on HTTPS";)
alert tcp any any -> any 8080 (flags:"PSH"; msg:"TCP PUSH on 8080";)